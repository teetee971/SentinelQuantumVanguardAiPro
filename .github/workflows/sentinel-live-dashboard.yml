name: ğŸŒ Wave 15 â€“ Sentinel Live Dashboard (Real-Time Visualization)

on:
  schedule:
    - cron: "*/30 * * * *"     # rafraÃ®chit toutes les 30 minutes
  workflow_dispatch:

jobs:
  dashboard:
    runs-on: ubuntu-latest
    name: ğŸ›°ï¸ Sentinel Dashboard Generator
    steps:
      - name: ğŸš€ Initialisation
        run: |
          echo "ğŸŒ Lancement du gÃ©nÃ©rateur de dashboard Sentinel"
          mkdir -p public/status logs

      - name: ğŸ“¥ TÃ©lÃ©chargement des logs fusionnÃ©s
        uses: actions/download-artifact@v4
        with:
          name: sentinel-log-fusion
          path: logs/

      - name: ğŸ§  GÃ©nÃ©ration du tableau de bord
        run: |
          echo "<!DOCTYPE html><html lang='fr'><head><meta charset='UTF-8'><title>Sentinel Live Dashboard</title>" > public/status/index.html
          echo "<meta name='viewport' content='
# 1ï¸âƒ£ Se placer Ã  la racine du projet
cd ~/SentinelQuantumVanguardAiPro

# 2ï¸âƒ£ CrÃ©er le workflow
mkdir -p .github/workflows
cat > .github/workflows/sentinel-live-dashboard.yml <<'EOF'
name: ğŸŒ Wave 15 â€“ Sentinel Live Dashboard (Real-Time Visualization)

on:
  schedule:
    - cron: "*/30 * * * *"     # rafraÃ®chit toutes les 30 minutes
  workflow_dispatch:

jobs:
  dashboard:
    runs-on: ubuntu-latest
    name: ğŸ›°ï¸ Sentinel Dashboard Generator
    steps:
      - name: ğŸš€ Initialisation
        run: |
          echo "ğŸŒ Lancement du gÃ©nÃ©rateur de dashboard Sentinel"
          mkdir -p public/status logs

      - name: ğŸ“¥ TÃ©lÃ©chargement des logs fusionnÃ©s
        uses: actions/download-artifact@v4
        with:
          name: sentinel-log-fusion
          path: logs/

      - name: ğŸ§  GÃ©nÃ©ration du tableau de bord
        run: |
          echo "<!DOCTYPE html><html lang='fr'><head><meta charset='UTF-8'><title>Sentinel Live Dashboard</title>" > public/status/index.html
          echo "<meta name='viewport' content='width=device-width,initial-scale=1'><style>body{font-family:Inter,Roboto,Arial;background:#0b0f19;color:#e5e5e5;padding:2em;}h1{color:#00ffe0;}pre{background:#111827;padding:1em;border-radius:12px;white-space:pre-wrap;}</style></head><body>" >> public/status/index.html
          echo "<h1>ğŸ›°ï¸ Sentinel Live Dashboard</h1><p>Mise Ã  jour : $(date '+%F %T')</p><hr>" >> public/status/index.html
          echo "<h2>Derniers rapports fusionnÃ©s</h2><pre>" >> public/status/index.html
          tail -n 50 logs/fusion-summary.log >> public/status/index.html || echo "Aucune donnÃ©e disponible" >> public/status/index.html
          echo "</pre><hr><p style='font-size:0.9em;color:#888'>Â© $(date +%Y) Sentinel Quantum Vanguard AI Pro â€“ Surveillance Active</p></body></html>" >> public/status/index.html

      - name: ğŸ§¾ Validation du fichier
        run: |
          echo "âœ… Dashboard gÃ©nÃ©rÃ© :"
          head -n 10 public/status/index.html

      - name: ğŸ“² Notification Telegram (optionnelle)
        if: always()
        run: |
          if [ -n "${{ secrets.TELEGRAM_WEBHOOK }}" ]; then
            MSG="ğŸŒ Dashboard mis Ã  jour $(date '+%T') â€“ accessible via /public/status "
            curl -s -X POST ${{ secrets.TELEGRAM_WEBHOOK }} -d "text=$MSG"
          fi

      - name: ğŸ—‚ï¸ Upload du tableau de bord
        uses: actions/upload-artifact@v4
        with:
          name: sentinel-live-dashboard
          path: public/status/
